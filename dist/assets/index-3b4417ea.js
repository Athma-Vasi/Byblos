import{r as w,A as Ie,k as q,m as D,R as _,o as se,n as De,T as Ce,w as Me,u as Ne,d as je,j as L,F as J,a as u,g as V,S as Re,O as Ae,t as Le,l as Q}from"./index-031fa283.js";import{a as Ve,b as Te}from"./index.esm-c48e3429.js";import{d as He,e as Be}from"./index.esm-65c92dff.js";import{V as ze}from"./index.esm-eb47e553.js";import{P as G,i as Fe}from"./Popover-411edea3.js";import{c as O,u as Ue}from"./use-delayed-hover-c55022b3.js";import{u as Ke,a as qe}from"./use-reduced-motion-017d389a.js";import{N as R}from"./NavLink-b4e14e59.js";import"./get-default-z-index-b47c3510.js";function T(e,r){let o=e;for(;(o=o.parentElement)&&!o.matches(r););return o}function We(e,r,o){for(let t=e-1;t>=0;t-=1)if(!r[t].disabled)return t;if(o){for(let t=r.length-1;t>-1;t-=1)if(!r[t].disabled)return t}return e}function Ge(e,r,o){for(let t=e+1;t<r.length;t+=1)if(!r[t].disabled)return t;if(o){for(let t=0;t<r.length;t+=1)if(!r[t].disabled)return t}return e}function Je(e,r,o){return T(e,o)===T(r,o)}function Qe({parentSelector:e,siblingSelector:r,onKeyDown:o,loop:t=!0,activateOnFocus:c=!1,dir:i="rtl",orientation:a}){return n=>{var p;o==null||o(n);const l=Array.from(((p=T(n.currentTarget,e))==null?void 0:p.querySelectorAll(r))||[]).filter(m=>Je(n.currentTarget,m,e)),s=l.findIndex(m=>n.currentTarget===m),d=Ge(s,l,t),h=We(s,l,t),b=i==="rtl"?h:d,f=i==="rtl"?d:h;switch(n.key){case"ArrowRight":{a==="horizontal"&&(n.stopPropagation(),n.preventDefault(),l[b].focus(),c&&l[b].click());break}case"ArrowLeft":{a==="horizontal"&&(n.stopPropagation(),n.preventDefault(),l[f].focus(),c&&l[f].click());break}case"ArrowUp":{a==="vertical"&&(n.stopPropagation(),n.preventDefault(),l[h].focus(),c&&l[h].click());break}case"ArrowDown":{a==="vertical"&&(n.stopPropagation(),n.preventDefault(),l[d].focus(),c&&l[d].click());break}case"Home":{n.stopPropagation(),n.preventDefault(),!l[0].disabled&&l[0].focus();break}case"End":{n.stopPropagation(),n.preventDefault();const m=l.length-1;!l[m].disabled&&l[m].focus();break}}}}function Xe(e,r,o){var t;return o?Array.from(((t=T(o,r))==null?void 0:t.querySelectorAll(e))||[]).findIndex(c=>c===o):null}function Ye(){const[e,r]=w.useState(-1);return[e,{setHovered:r,resetHovered:()=>r(-1)}]}const ie={context:"Menu component was not found in the tree",children:"Menu.Target component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported"},[Ze,A]=Ie(ie.context);var er=q(e=>({divider:{margin:`calc(${e.spacing.xs}px / 2) -5px`,borderTop:`1px solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[2]}`}}));const rr=er;var or=Object.defineProperty,H=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,X=(e,r,o)=>r in e?or(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,tr=(e,r)=>{for(var o in r||(r={}))ce.call(r,o)&&X(e,o,r[o]);if(H)for(var o of H(r))de.call(r,o)&&X(e,o,r[o]);return e},nr=(e,r)=>{var o={};for(var t in e)ce.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&H)for(var t of H(e))r.indexOf(t)<0&&de.call(e,t)&&(o[t]=e[t]);return o};const ar={},ue=w.forwardRef((e,r)=>{const o=D("MenuDivider",ar,e),{children:t,className:c}=o,i=nr(o,["children","className"]),{classNames:a,styles:n,unstyled:p}=A(),{classes:l,cx:s}=rr(null,{name:"Menu",classNames:a,styles:n,unstyled:p});return _.createElement(se,tr({className:s(l.divider,c),ref:r},i))});ue.displayName="@mantine/core/MenuDivider";var lr=Object.defineProperty,B=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,Y=(e,r,o)=>r in e?lr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,sr=(e,r)=>{for(var o in r||(r={}))pe.call(r,o)&&Y(e,o,r[o]);if(B)for(var o of B(r))fe.call(r,o)&&Y(e,o,r[o]);return e},ir=(e,r)=>{var o={};for(var t in e)pe.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&B)for(var t of B(e))r.indexOf(t)<0&&fe.call(e,t)&&(o[t]=e[t]);return o};const cr={};function me(e){const r=D("MenuDropdown",cr,e),{children:o,onMouseEnter:t,onMouseLeave:c}=r,i=ir(r,["children","onMouseEnter","onMouseLeave"]),a=w.useRef(),n=A(),p=d=>{(d.key==="ArrowUp"||d.key==="ArrowDown")&&(d.preventDefault(),a.current.querySelectorAll("[data-menu-item]")[0].focus())},l=O(t,()=>n.trigger==="hover"&&n.openDropdown()),s=O(c,()=>n.trigger==="hover"&&n.closeDropdown());return _.createElement(G.Dropdown,sr({onMouseEnter:l,onMouseLeave:s,role:"menu","aria-orientation":"vertical"},i),_.createElement("div",{tabIndex:-1,"data-menu-dropdown":!0,"data-autofocus":!0,onKeyDown:p,ref:a,style:{outline:0}},o))}me.displayName="@mantine/core/MenuDropdown";var dr=Object.defineProperty,ur=Object.defineProperties,pr=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertySymbols,fr=Object.prototype.hasOwnProperty,mr=Object.prototype.propertyIsEnumerable,ee=(e,r,o)=>r in e?dr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,vr=(e,r)=>{for(var o in r||(r={}))fr.call(r,o)&&ee(e,o,r[o]);if(Z)for(var o of Z(r))mr.call(r,o)&&ee(e,o,r[o]);return e},hr=(e,r)=>ur(e,pr(r)),gr=q((e,{color:r,radius:o})=>({item:hr(vr({},e.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",fontSize:e.fontSizes.sm,border:0,backgroundColor:"transparent",outline:0,width:"100%",textAlign:"left",textDecoration:"none",boxSizing:"border-box",padding:`${e.spacing.xs}px ${e.spacing.sm}px`,cursor:"pointer",borderRadius:e.fn.radius(o),color:r?e.fn.variant({variant:"filled",primaryFallback:!1,color:r}).background:e.colorScheme==="dark"?e.colors.dark[0]:e.black,display:"flex",alignItems:"center","&:disabled":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[5],pointerEvents:"none",userSelect:"none"},"&[data-hovered]":{backgroundColor:r?e.fn.variant({variant:"light",color:r}).background:e.colorScheme==="dark"?e.fn.rgba(e.colors.dark[3],.35):e.colors.gray[1]}}),itemLabel:{flex:1},itemIcon:{display:"flex",justifyContent:"center",alignItems:"center",marginRight:e.spacing.xs},itemRightSection:{}}));const yr=gr;var _r=Object.defineProperty,wr=Object.defineProperties,br=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,re=(e,r,o)=>r in e?_r(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,Or=(e,r)=>{for(var o in r||(r={}))ve.call(r,o)&&re(e,o,r[o]);if(z)for(var o of z(r))he.call(r,o)&&re(e,o,r[o]);return e},Pr=(e,r)=>wr(e,br(r)),$r=(e,r)=>{var o={};for(var t in e)ve.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&z)for(var t of z(e))r.indexOf(t)<0&&he.call(e,t)&&(o[t]=e[t]);return o};const kr={},ge=w.forwardRef((e,r)=>{const o=D("MenuItem",kr,e),{children:t,className:c,color:i,closeMenuOnClick:a,icon:n,rightSection:p}=o,l=$r(o,["children","className","color","closeMenuOnClick","icon","rightSection"]),s=A(),{classes:d,cx:h,theme:b}=yr({radius:s.radius,color:i},{name:"Menu",classNames:s.classNames,styles:s.styles,unstyled:s.unstyled}),f=w.useRef(),m=s.getItemIndex(f.current),g=l,y=O(g.onMouseLeave,()=>s.setHovered(-1)),C=O(g.onMouseEnter,()=>s.setHovered(s.getItemIndex(f.current))),M=O(g.onClick,()=>{typeof a=="boolean"?a&&s.closeDropdownImmediately():s.closeOnItemClick&&s.closeDropdownImmediately()}),N=O(g.onFocus,()=>s.setHovered(s.getItemIndex(f.current)));return _.createElement(se,Pr(Or({component:"button",type:"button"},l),{tabIndex:-1,onFocus:N,className:h(d.item,c),ref:Ke(f,r),role:"menuitem","data-menu-item":!0,"data-hovered":s.hovered===m?!0:void 0,onMouseEnter:C,onMouseLeave:y,onClick:M,onKeyDown:Qe({siblingSelector:"[data-menu-item]",parentSelector:"[data-menu-dropdown]",activateOnFocus:!1,loop:s.loop,dir:b.dir,orientation:"vertical",onKeyDown:g.onKeydown})}),n&&_.createElement("div",{className:d.itemIcon},n),t&&_.createElement("div",{className:d.itemLabel},t),p&&_.createElement("div",{className:d.itemRightSection},p))});ge.displayName="@mantine/core/MenuItem";const xr=De(ge);var Sr=q(e=>({label:{color:e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6],fontWeight:500,fontSize:e.fontSizes.xs,padding:`calc(${e.spacing.xs}px / 2) ${e.spacing.sm}px`,cursor:"default"}}));const Er=Sr;var Ir=Object.defineProperty,F=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,oe=(e,r,o)=>r in e?Ir(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,Dr=(e,r)=>{for(var o in r||(r={}))ye.call(r,o)&&oe(e,o,r[o]);if(F)for(var o of F(r))_e.call(r,o)&&oe(e,o,r[o]);return e},Cr=(e,r)=>{var o={};for(var t in e)ye.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&F)for(var t of F(e))r.indexOf(t)<0&&_e.call(e,t)&&(o[t]=e[t]);return o};const Mr={},we=w.forwardRef((e,r)=>{const o=D("MenuLabel",Mr,e),{children:t,className:c}=o,i=Cr(o,["children","className"]),{classNames:a,styles:n,unstyled:p}=A(),{classes:l,cx:s}=Er(null,{name:"Menu",classNames:a,styles:n,unstyled:p});return _.createElement(Ce,Dr({className:s(l.label,c),ref:r},i),t)});we.displayName="@mantine/core/MenuLabel";var Nr=Object.defineProperty,U=Object.getOwnPropertySymbols,be=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable,te=(e,r,o)=>r in e?Nr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,jr=(e,r)=>{for(var o in r||(r={}))be.call(r,o)&&te(e,o,r[o]);if(U)for(var o of U(r))Oe.call(r,o)&&te(e,o,r[o]);return e},Rr=(e,r)=>{var o={};for(var t in e)be.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&U)for(var t of U(e))r.indexOf(t)<0&&Oe.call(e,t)&&(o[t]=e[t]);return o};const Ar={refProp:"ref"},Pe=w.forwardRef((e,r)=>{const o=D("MenuTarget",Ar,e),{children:t,refProp:c}=o,i=Rr(o,["children","refProp"]);if(!Fe(t))throw new Error(ie.children);const a=A(),n=O(t.props.onClick,()=>a.trigger==="click"&&a.toggleDropdown()),p=O(t.props.onMouseEnter,()=>a.trigger==="hover"&&a.openDropdown()),l=O(t.props.onMouseLeave,()=>a.trigger==="hover"&&a.closeDropdown());return _.createElement(G.Target,jr({refProp:c,popupType:"menu",ref:r},i),w.cloneElement(t,{onClick:n,onMouseEnter:p,onMouseLeave:l,"data-expanded":a.opened?!0:void 0}))});Pe.displayName="@mantine/core/MenuTarget";var Lr=q({dropdown:{padding:4}});const Vr=Lr;var Tr=Object.defineProperty,Hr=Object.defineProperties,Br=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,$e=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,ne=(e,r,o)=>r in e?Tr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,ae=(e,r)=>{for(var o in r||(r={}))$e.call(r,o)&&ne(e,o,r[o]);if(K)for(var o of K(r))ke.call(r,o)&&ne(e,o,r[o]);return e},le=(e,r)=>Hr(e,Br(r)),zr=(e,r)=>{var o={};for(var t in e)$e.call(e,t)&&r.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&K)for(var t of K(e))r.indexOf(t)<0&&ke.call(e,t)&&(o[t]=e[t]);return o};const Fr={closeOnItemClick:!0,loop:!0,trigger:"click",openDelay:0,closeDelay:100};function v(e){const r=D("Menu",Fr,e),{children:o,onOpen:t,onClose:c,opened:i,defaultOpened:a,onChange:n,closeOnItemClick:p,loop:l,closeOnEscape:s,trigger:d,openDelay:h,closeDelay:b,classNames:f,styles:m,unstyled:g,radius:y}=r,C=zr(r,["children","onOpen","onClose","opened","defaultOpened","onChange","closeOnItemClick","loop","closeOnEscape","trigger","openDelay","closeDelay","classNames","styles","unstyled","radius"]),{classes:M,cx:N}=Vr(),[$,{setHovered:k,resetHovered:W}]=Ye(),[P,j]=qe({value:i,defaultValue:a,finalValue:!1,onChange:n}),x=()=>{j(!1),P&&(c==null||c())},E=()=>{j(!0),!P&&(t==null||t())},I=()=>P?x():E(),{openDropdown:S,closeDropdown:xe}=Ue({open:E,close:x,closeDelay:b,openDelay:h}),Se=Ee=>Xe("[data-menu-item]","[data-menu-dropdown]",Ee);return Me(()=>{W()},[P]),_.createElement(Ze,{value:{opened:P,toggleDropdown:I,getItemIndex:Se,hovered:$,setHovered:k,closeOnItemClick:p,closeDropdown:d==="click"?x:xe,openDropdown:d==="click"?E:S,closeDropdownImmediately:x,loop:l,trigger:d,radius:y,classNames:f,styles:m,unstyled:g}},_.createElement(G,le(ae({},C),{radius:y,opened:P,onChange:j,defaultOpened:a,trapFocus:d==="click",closeOnEscape:s&&d==="click",__staticSelector:"Menu",classNames:le(ae({},f),{dropdown:N(M.dropdown,f==null?void 0:f.dropdown)}),styles:m,unstyled:g,onClose:x,onOpen:E}),o))}v.displayName="@mantine/core/Menu";v.Item=xr;v.Label=we;v.Dropdown=me;v.Target=Pe;v.Divider=ue;function Zr({allStates:e,allActions:r,allDispatches:o}){const{volumeId:t}=Ne(),{width:c=0}=je(),[i,a]=w.useState({menu:!1,overview:!0,otherEditions:!1,publisherCollection:!1,authorCollection:!1}),[n,p]=w.useState(!1);let{responseState:{fetchUrl:l,startIndex:s,searchTerm:d,searchResults:h,selectedVolume:b,selectedAuthor:f,selectedPublisher:m,bookshelfVolumes:g},themeState:{theme:y},navlinksState:C}=e,{navlinksActions:M}=r,{navlinksDispatch:N}=o;const $={navlinksState:C,navlinksActions:M,navlinksDispatch:N};async function k(W,P){let{navlinksState:j,navlinksActions:x,navlinksDispatch:E}=P;Le(j,x,E);try{const I=await Q.getItem("byblos-historyState")??[{fetchUrl:l,startIndex:s,searchTerm:d,searchResults:h,selectedVolume:b,selectedAuthor:f,selectedPublisher:m,bookshelfVolumes:g}];I.push({fetchUrl:l,startIndex:s,searchTerm:d,searchResults:h,selectedVolume:b,selectedAuthor:f,selectedPublisher:m,bookshelfVolumes:g}),await Q.setItem("byblos-historyState",I)}catch(I){const S=new Error(I,{cause:"handleNavLinkActiveClick()"});console.group("Error in displayVolume eventHandler"),console.error("name: ",S.name),console.error("message: ",S.message),console.error("cause: ",S.cause),console.groupCollapsed("stack trace"),console.trace(S),console.error("detailed stack trace",S.stack),console.groupEnd()}switch(W){case"Menu":{a({...i,menu:!0});break}case"Overview":{a({...i,menu:!1,overview:!0,otherEditions:!1,publisherCollection:!1,authorCollection:!1});break}case"Other editions":{a({...i,menu:!1,overview:!1,otherEditions:!0,publisherCollection:!1,authorCollection:!1});break}case"Publisher collection":{a({...i,menu:!1,overview:!1,otherEditions:!1,publisherCollection:!0,authorCollection:!1});break}case"Author collection":{a({...i,menu:!1,overview:!1,otherEditions:!1,publisherCollection:!1,authorCollection:!0});break}default:{a({...i,menu:!1,overview:!0,otherEditions:!1,publisherCollection:!1,authorCollection:!1});break}}}return L(J,{direction:"column",align:"center",justify:"center",style:{width:"100%"},children:[L(v,{position:"bottom-start",transition:c<576?"slide-left":"slide-down",transitionDuration:382,radius:"sm",children:[u(v.Target,{children:u(R,{active:i.menu,label:"Menu",variant:"light",icon:u(Ve,{size:20,style:{color:`${y==="light"?"#B06519":"#B87333"}`}}),"data-cy":"menu-displayVolume",onClick:()=>{k("Menu",$),p(!n)},style:{width:"auto",marginRight:"auto",marginLeft:"1rem",borderRadius:"0.25rem"}})}),L(v.Dropdown,{children:[u(v.Label,{color:y==="light"?"dark.6":"gray.5",children:"Navigate to"}),L(J,{direction:c<576?"column":"row",children:[u(v.Item,{children:u(V,{to:`/home/displayVolume/${t}/overview`,className:"overview-navlink",children:u(R,{active:i.overview,label:"Overview",variant:"subtle",icon:u(He,{size:20,style:{color:`${y==="light"?"#B06519":"#B87333"}`}}),"data-cy":"menu-overview-displayVolume",onClick:()=>k("Overview",$)})})}),u(v.Item,{children:u(V,{to:`/home/displayVolume/${t}/otherEditions`,className:"otherEditions-navlink",children:u(R,{active:i.otherEditions,label:"Other editions",variant:"subtle",icon:u(ze,{size:20,style:{color:`${y==="light"?"#B06519":"#B87333"}`}}),"data-cy":"menu-otherEditions-displayVolume",onClick:()=>k("Other editions",$)})})}),u(v.Item,{children:u(V,{to:`/home/displayVolume/${t}/publisherCollection`,className:"publisherCollection-navlink",children:u(R,{active:i.publisherCollection,label:"Publisher collection",variant:"subtle",icon:u(Be,{size:20,style:{color:`${y==="light"?"#B06519":"#B87333"}`}}),"data-cy":"menu-publisherCollection-displayVolume",onClick:()=>k("Publisher collection",$)})})}),u(v.Item,{children:u(V,{to:`/home/displayVolume/${t}/authorCollection`,className:"authorCollection-navlink",children:u(R,{active:i.authorCollection,label:"Author collection",variant:"subtle",icon:u(Te,{size:20,style:{color:`${y==="light"?"#B06519":"#B87333"}`}}),"data-cy":"menu-authorCollection-displayVolume",onClick:()=>k("Author collection",$)})})})]})]})]}),u(Re,{h:"xs"}),u(Ae,{})]})}export{Zr as default};
